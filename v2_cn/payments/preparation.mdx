---
title: "开发环境前置准备"
lang: "zh-hans"
description: ""
---

本文介绍如何在开发环境下完成支付功能集成前的准备工作，帮助您验证功能并确保集成正常运行。

**后续步骤：**
完成开发环境验证后，当您准备将支付功能部署到生产环境时，请参考[生产环境前置准备](/v2_cn/payments/preparation-prod)获取相关指引。


## 前提条件

* [联系我们的销售团队](https://www.cobo.com/zh/book-demo?utm_source=product-manual&utm_medium=product&utm_campaign=pricing-plan-intro&utm_content=enterprise-contact-sales)获取您的账户激活链接。

* 一台用于运行 [Cobo Guard](https://manuals.cobo.com/cn/guard/introduction) 的 iOS 设备，这是我们专门用于多因素认证（MFA）、操作审批、交易签名和私钥分片管理的应用程序。

## 基础准备

### 创建账户并设置 Cobo Guard
作为团队的第一位管理员，请使用我们销售团队提供的激活链接创建您的 Cobo Portal 开发环境账户。创建后，请按照以下步骤设置 Cobo Guard：

1. 登录 Cobo Portal [开发环境](https://portal.dev.cobo.com/login)。
2. 点击左下角的**指南**，然后点击**绑定 Cobo Guard**。
   <img src="/v2_cn/images/payments/cobo-guard.png" className="screenshot_nav_bar" alt="绑定 Cobo Guard"/>
3. 按照屏幕上的说明在您的 iOS 设备上安装 Cobo Guard，并将您的账户与 Cobo Guard 关联。

### 邀请成员
1. 登录 Cobo Portal [开发环境](https://portal.dev.cobo.com/login)。
2. 点击左下角的个人资料图标，然后点击**团队**。
3. 点击**成员**。在**成员**页面，点击**邀请成员**。
4. 输入成员的邮箱地址和姓名，然后选择适当的[用户角色](/v2_cn/payments/roles-and-permissions)。
<Note>请在 Cobo Guard 上确认此邀请是由您发起的。另外，根据默认的业务风控规则，至少需要半数以上的团队管理员在 Cobo Guard 上批准邀请请求。</Note>

   收到邀请后，新成员应按照前面的章节所述创建自己的账户并设置 Cobo Guard。

### 安装 Payments App

Payments App 提供 Web 界面，让您可以便捷地进行收款查询、资金管理、资金转出等日常运营工作。安装步骤如下：

1. 登录 Cobo Portal [开发环境](https://portal.dev.cobo.com/login)。

2. 在首页点击 **Payments** 卡片。
<img src="/v2_cn/images/payments/install-payment-app.png" className="screenshot_modal" alt="Payments App Intro" />

3. 点击**安装**按钮并按页面指引完成安装。**钱包范围**可选择**任何类型钱包**。

4. 如页面提示需要管理员审批，请通知管理员在 Cobo Guard 上审批。审批通过后，App 将自动完成安装。

## 技术配置

### Payments API 调用准备

如果您需要调用 Payments API，则需要参考以下步骤，完成 API Key 的配置。

1. 参考[开发者指南](/v2_cn/guides/get-started/get-started-with-waas)，生成一对 API Key 和 API Secret，并在 Cobo Portal 注册该 API Key。请注意以下配置：
   * **用户角色**：选择**支付管理员**
   * **钱包范围**：选择**任何类型钱包**
   * 无需配置 Callback Endpoint
   * **密钥类型**：选择**临时**

2. 如果您选择使用 SDK 而不是手动编写 API 请求，则需要安装对应编程语言的 SDK：
   - [Python SDK 快速入门](/v2_cn/developer-tools/quickstart-python)
   - [Java SDK 快速入门](/v2_cn/developer-tools/quickstart-java) 
   - [Go SDK 快速入门](/v2_cn/developer-tools/quickstart-go)
   - [JavaScript SDK 快速入门](/v2_cn/developer-tools/quickstart-javascript)

### 订阅 Webhook 事件

如果您需要收到支付相关事件的实时通知，可以搭建并注册 Webhook Endpoint，用于接收 Webhook 事件。具体步骤如下：

* 参考[开发者指南](/v2_cn/guides/webhooks-callbacks/set-up-endpoint)，搭建 Webhook Endpoint。  
* 在 Cobo Portal [注册该 Webhook Endpoint](https://manuals.cobo.com/cn/portal/developer-console/webhooks-create)，并订阅[支付相关的 Webhook 事件](/v2_cn/payments/status-and-events)。

### (可选) 配置 Callback Endpoint

为了提供额外的资金安全保障，您可以配置 Callback Endpoint 来审批资金转出请求。配置后，当发生法币出金或加密货币转账时，Cobo 会向您的 Callback Endpoint 发送包含完整交易信息的请求。只有在您的 Callback Endpoint 返回响应进行批准后，交易才会继续进行。
* 参考[开发者指南](/v2_cn/guides/webhooks-callbacks/set-up-endpoint)，搭建 Callback Endpoint，并实现处理逻辑。  
* 在 Cobo Portal [注册该 Callback Endpoint](https://manuals.cobo.com/cn/portal/developer-console/callbacks-register)。


## 业务配置


<a id="merchants"></a>
### 创建商户

您可以使用 Payments App 或 Payments API 创建商户。

- 如果您直接服务付款方，则可以直接使用系统默认创建的商户（商户名称与您的组织名称相同）。如果您想要为不同的业务线单独管理资金，也可以创建多个商户。
- 如果您是服务多个下游商户的平台机构，则建议创建多个商户，并为每个商户配置专属的开发者费率，以实现商户的自动分账与结算。
- 更多关于商户管理的使用场景和说明，可以参考[商户管理](/v2_cn/payments/merchants)。


<Tabs>
  <Tab title="Payments App" icon="pager">
  1. 登录 Cobo Portal [开发环境](https://portal.dev.cobo.com/login)。
  2. 在左侧导航栏中点击 **Apps**，然后点击 **Payments** 卡片，启动 App。
  3. 在 App 的左侧导航栏中点击**商户**。
  4. 点击**创建商户**按钮。
  5. 在弹窗中完成如下配置：
     <img src="/v2_cn/images/payments/create_merchant.png" className="screenshot_full_screen" alt="Create Merchant Modal" />
     - 填写商户名称。
     - 选择**钱包设置**。每个钱包包含多个加密货币地址，作为商户的收款地址。根据您的业务需求，可以选择以下两种钱包设置：
       - **共用钱包**：多个商户共享同一个钱包。该钱包的地址可能同时用于接收多个商户的收款。
       - **独立钱包**：为商户创建专属钱包，实现资金完全隔离。该钱包的所有地址仅用于接收该商户的收款。
     - 如果您选择使用充值或者订阅模式，您还可以设置**开发者费率**。开发者费率决定了您作为开发者从每笔收款中获得的分成比例。例如，设置为 1% 意味着每笔收款中的 1% 将作为开发者费用分配给您。您可以在创建商户后随时调整开发者费率。更多关于开发者费率和资金分配的详细说明，请参考[资金分配与余额管理](/v2_cn/payments/amounts-and-balances)。

如果您的后续操作涉及到 API 调用，则可以在创建完成后点击**查看详情**按钮获取并保存商户 ID。您需要在后续 API 调用中使用商户 ID 来标识该商户。

  </Tab>
  <Tab title="Payments API" icon="code">

1. 调用 [Create merchant](/v2/api-references/payment/create-merchant) 创建商户，在请求中传入以下信息：  
   * `name`: 商户名称
   * `wallet_setup`: （可选）钱包设置。每个钱包包含多个加密货币地址，作为商户的收款地址。根据您的业务需求，可以选择以下两种钱包设置：
       - **Shared**（默认）：多个商户共享同一个钱包。该钱包的地址可能同时用于接收多个商户的收款。
       - **Separate**：为商户创建专属钱包，实现资金完全隔离。该钱包的所有地址仅用于接收该商户的收款。
   * `developer_fee_rate`: （可选）如果您选择使用充值或者订阅模式，您还可以设置开发者费率。开发者费率决定了您作为开发者从每笔收款中获得的分成比例。例如，设置为 1% 意味着每笔收款中的 1% 将作为开发者费用分配给您。您可以在创建商户后随时调整开发者费率。更多关于开发者费率和资金分配的详细说明，请参考[资金分配与余额管理](/v2_cn/payments/amounts-and-balances)。


   调用后，您将获取到商户 ID (`merchant_id`)，作为该商户在 Cobo 系统中的唯一标识符，用于后续 API 调用中标识该商户。

**调用示例**

以下为调用 [Create merchant](/v2/api-references/payment/create-merchant) 创建商户的示例代码：

<Accordion title="Sample code in Python">
```py
import cobo_waas2
from cobo_waas2 import PaymentApi
# See configuration.py for a list of all supported configurations.
configuration = cobo_waas2.Configuration(
   # Replace `<YOUR_PRIVATE_KEY>` with your private key
   api_private_key="<YOUR_PRIVATE_KEY>",
   # Select the development environment. To use the production environment, change the URL to https://api.cobo.com/v2.
   host="https://api.dev.cobo.com/v2",
)
# Enter a context with an instance of the API client
with cobo_waas2.ApiClient(configuration) as api_client:
   # Create an instance of the API class
   api_instance = cobo_waas2.PaymentApi(api_client)
   create_merchant_request = cobo_waas2.CreateMerchantRequest(name="<YOUR_MERCHANT_NAME>")


   try:
       # Create merchant
       api_response = api_instance.create_merchant(
           create_merchant_request=create_merchant_request
       )
       print("The response of PaymentApi->create_merchant:\n")
       print(api_response)
   except Exception as e:
       print("Exception when calling PaymentApi->create_merchant: %s\n" % e)
```
</Accordion>

<Accordion title="Sample code in Java">
```java
import com.cobo.waas2.ApiClient;
import com.cobo.waas2.ApiException;
import com.cobo.waas2.Configuration;
import com.cobo.waas2.Env;
import com.cobo.waas2.api.PaymentApi;
import com.cobo.waas2.model.*;


public class Example {
 public static void main(String[] args) {
   ApiClient defaultClient = Configuration.getDefaultApiClient();
   // Select the development environment. To use the production environment, replace `Env.DEV` with
   // `Env.PROD
   defaultClient.setEnv(Env.DEV);


   // Replace `<YOUR_PRIVATE_KEY>` with your private key
   defaultClient.setPrivKey("<YOUR_PRIVATE_KEY>");
   PaymentApi apiInstance = new PaymentApi(defaultClient);
   CreateMerchantRequest createMerchantRequest = new CreateMerchantRequest();
   createMerchantRequest.setName("<YOUR_MERCHANT_NAME>");
   try {
          Merchant merchant = apiInstance.createMerchant(createMerchantRequest);
         System.out.println(merchant);
   } catch (ApiException e) {
     System.err.println("Exception when calling PaymentApi#createMerchant");
   }
 }
}
```
</Accordion>

  </Tab>
</Tabs>


### 向 Fee Station 充值

在您日常开展业务过程中，需要通过 [Fee Station](https://manuals.cobo.com/cn/portal/fee-station/introduction) 管理在 Cobo 产生的各类费用。在您开始集成之前，请确保您的 Fee Station 中有足够的资金用于支付资金转出、退款等环节产生的手续费：

- 您可以使用 USDT 或 USDC 作为手续费币种
- 建议初始充值金额为 50 美元左右的等值加密货币。您可以根据实际业务需求调整充值金额。

具体的充值操作步骤，请参考[向 Fee Station 充值](https://manuals.cobo.com/cn/portal/fee-station/deposit)文档。

## 后续步骤

参考[功能列表](/v2_cn/payments/features#收款)，选择适合您的收款模式，并参考文档完成收款功能集成。

<Tip>欢迎您[提交反馈](https://forms.zohopublic.com/cobo/form/DocumentFeedbackForm/formperma/QvLOhxJv1_JMsJ-1dleZ8Itb_7rzN-LtgvsDdxosoVI)来帮助改进我们的文档！</Tip>